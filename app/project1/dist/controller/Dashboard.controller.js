sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast"],function(e,t,r){"use strict";return e.extend("project1.controller.Dashboard",{onInit:function(){var e=new t;e.loadData("model/products.json");e.attachRequestCompleted(()=>{const t=e.getData().filteredProducts;e.setProperty("/filteredProducts",t);e.setProperty("/originalProducts",JSON.parse(JSON.stringify(t)))});this.getView().setModel(e,"products");if(!this.getOwnerComponent().getModel("cart")){var r=new t({items:[],total:0});this.getOwnerComponent().setModel(r,"cart")}if(!this.getOwnerComponent().getModel("orders")){var o=new t({orders:[]});this.getOwnerComponent().setModel(o,"orders")}},onAddToCart:function(e){var t=e.getSource().getBindingContext("products").getObject();var o=this.getOwnerComponent().getModel("cart");var n=o.getProperty("/items")||[];var a=n.find(e=>e.id===t.id);if(a){a.quantity+=1}else{n.push({id:t.id,name:t.name,image:t.image,price:t.price,quantity:1})}o.setProperty("/items",n);this._updateCartTotal();r.show("Added to cart")},_updateCartTotal:function(){var e=this.getOwnerComponent().getModel("cart");var t=e.getProperty("/items")||[];var r=t.reduce((e,t)=>e+t.price*t.quantity,0);e.setProperty("/total",r)},onSearch:function(e){var t=e.getParameter("newValue")||e.getParameter("value");var r=this.getView().getModel("products");var o=r.getProperty("/originalProducts");var n=t?o.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())):o;r.setProperty("/filteredProducts",n)},onSort:function(e){var t=e.getParameter("selectedItem").getKey();var r=this.getView().getModel("products");var o=r.getProperty("/filteredProducts")||[];if(t==="asc"){o.sort((e,t)=>e.price-t.price)}else if(t==="desc"){o.sort((e,t)=>t.price-e.price)}r.setProperty("/filteredProducts",o)},onNavToDashboard:function(){this.getOwnerComponent().getRouter().navTo("RouteDashboard")},onNavToCart:function(){this.getOwnerComponent().getRouter().navTo("RouteCart")},onNavToOrders:function(){this.getOwnerComponent().getRouter().navTo("RouteOrders")}})});
//# sourceMappingURL=Dashboard.controller.js.map